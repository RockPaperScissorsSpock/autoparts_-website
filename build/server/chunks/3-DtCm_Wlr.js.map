{"version":3,"file":"3-DtCm_Wlr.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/administration/_page.server.js","../../../.svelte-kit/adapter-node/nodes/3.js"],"sourcesContent":["import { r as redirect } from \"../../../chunks/index.js\";\nimport sqlite3 from \"sqlite3\";\nimport \"mysql2/promise\";\nconst sqlite = sqlite3.verbose();\nasync function weights_query() {\n  return new Promise((resolve, reject) => {\n    let database_instance = new sqlite.Database(\"./db/projectdb.sl3\");\n    database_instance.serialize(() => {\n      let fetch_full_order = `SELECT * FROM WeightTable;`;\n      database_instance.all(fetch_full_order, (error, data) => {\n        if (error)\n          console.log(error);\n        return resolve(data);\n      });\n    });\n  });\n}\nasync function update_weights(weights) {\n  return new Promise((resolve, reject) => {\n    let database_instance = new sqlite.Database(\"./db/projectdb.sl3\");\n    database_instance.serialize(() => {\n      let delete_all = `DELETE FROM WeightTable;`;\n      let reinsert = `INSERT INTO WeightTable (ID, weight_maximum, price) VALUES `;\n      let index_start = 1;\n      for (let i = 0; i < weights.length; ++i) {\n        reinsert += `(${index_start++}, ${weights[i].weight}, ${weights[i].price})`;\n        if (i < weights.length - 1)\n          reinsert += `,`;\n      }\n      reinsert += `;`;\n      database_instance.run(delete_all, (error) => {\n        if (error)\n          console.log(error);\n      });\n      database_instance.run(reinsert, (error) => {\n        if (error)\n          console.log(error);\n        resolve();\n      });\n    });\n  });\n}\nfunction sort_weights(weights) {\n  weights.sort((a, b) => {\n    return a.weight - b.weight;\n  });\n}\nasync function load({ params }) {\n  let results = await weights_query();\n  console.log(results);\n  let weights = [];\n  results.forEach((res) => {\n    weights.push({ weight: res.weight_maximum, price: res.price, id: res.ID });\n  });\n  sort_weights(weights);\n  return {\n    weight_table: weights\n  };\n}\nconst actions = {\n  updateWeights: async (request) => {\n    const form_data = await request.request.formData();\n    const weights = form_data.getAll(\"weight\");\n    const prices = form_data.getAll(\"price\");\n    let w = [];\n    for (let i = 0; i < weights.length; ++i) {\n      w.push({ weight: weights[i], price: prices[i] });\n    }\n    sort_weights(w);\n    await update_weights(w);\n    redirect(301, \"/administration\");\n  }\n};\nexport {\n  actions,\n  load\n};\n","import * as server from '../entries/pages/administration/_page.server.js';\n\nexport const index = 3;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/administration/_page.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/administration/+page.server.js\";\nexport const imports = [\"_app/immutable/nodes/3.CBYoSlI1.js\",\"_app/immutable/chunks/14.NBuK3kfd.js\",\"_app/immutable/chunks/index.BkIfBQf8.js\",\"_app/immutable/chunks/each.D6YF6ztN.js\",\"_app/immutable/chunks/entry.Dlt0aQ84.js\"];\nexport const stylesheets = [];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}